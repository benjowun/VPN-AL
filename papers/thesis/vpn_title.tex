%----------------------------------------------------------------
%
%  File    			:  thesis-title.tex
%
%  Author  			: Benjamin Wunderling
%  Template from	: Keith Andrews, IICM, TU Graz, Austria	
% 
%----------------------------------------------------------------


% --- Main Title Page ------------------------------------------------

\iffalse
\vspace*{2cm}


\begin{center}
\begin{spacing}{1.1}
\Huge\sffamily\bfseries
Model Learning and Fuzzing of the IPsec-IKEv1 VPN Protocol\\
\end{spacing}

\vspace{3cm}

% \LARGE \sffamily Draft 0.9

\vspace{3cm}

{\LARGE\sffamily
Benjamin Wunderling
}
\end{center}



% --- English Title Page ------------------------------------------------


% based on:
% https://tu4u.tugraz.at/fileadmin/Studierende_und_Bedienstete/Formulare/Diplomarbeit_Vorlage.pdf



\cleardoublepage
\fi

\vspace*{-3cm}

\begin{center}
\includegraphics[height=1cm]{diagrams/tugraz-logo.pdf}

\vspace{3cm}

{\Large\sffamily Benjamin Wunderling, BSc}

\vspace{1cm}

\begin{spacing}{1.1}
\huge\sffamily\bfseries
Model Learning and Fuzzing of the IPsec-IKEv1 VPN Protocol\\
\end{spacing}

\vspace{3cm}


{\Large\sffamily\bfseries Master's Thesis}

\vspace{5mm}

{\small\sffamily to achieve the university degree of}

\vspace{5mm}

{\normalsize\sffamily Diplom-Ingenieur}

\vspace{5mm}

{\normalsize\sffamily
Master's Degree Programme: Computer Science
}


\vspace{1cm}

{\small\sffamily submitted to}

\vspace{5mm}

{\large\sffamily\bfseries Graz University of Technology}



\vspace{1cm}

{\small\sffamily Supervisor}

\vspace{5mm}

{\normalsize\sffamily
Ao.Univ.-Prof.\ Dipl-Ing.\ Dr.\ Bernhard K.~Aichernig \\
Institute of Software Technology (IST)
}


\vspace{1cm}

{\normalsize\sffamily Graz, \thisdate}



\vfill


\end{center}





% --- Pledge ----------------------------------------------------

\cleardoublepage

\vspace*{2cm}


% adapted from:
% https://tu4u.tugraz.at/fileadmin/Studierende_und_Bedienstete/Formulare/Diplomarbeit_Vorlage.pdf
% https://tu4u.tugraz.at/fileadmin/Studierende_und_Bedienstete/Forms/Diploma_thesis_template.pdf
% Email vom 2. Sept. 2015

% and

% Beschluss der Curricula-Kommission für Bachelor-,
% Master- und Diplomstudien vom 10.11.2008
% Genehmigung des Senates am 1.12.2008



\subsection*{Statutory Declaration}
\noindent
\textit{
I declare that I have authored this thesis independently, that I have
not used other than the declared sources / resources, and that I have
explicitly indicated all material which has been quoted either
literally or by content from the sources used. The document uploaded
to TUGRAZonline is identical to the present thesis.}

\vspace{1cm}


\begin{otherlanguage}{austrian}

\subsection*{Eidesstattliche Erklärung}
\noindent
\textit{
Ich erkläre an Eides statt, dass ich die vorliegende Arbeit
selbstständig verfasst, andere als die angegebenen Quellen/Hilfsmittel
nicht benutzt, und die den benutzten Quellen wörtlich und inhaltlich
entnommenen Stellen als solche kenntlich gemacht habe. Das in
TUGRAZonline hochgeladene Dokument ist mit der vorliegenden
Arbeit identisch.}

\vspace{2cm}

\noindent
\parbox[top]{4cm}{
\begin{center}
\underline{\hspace*{4cm}} \\
Date/Datum
\end{center}
}
%
\hfill
%
\parbox[top]{6cm}{
\begin{center}
\underline{\hspace*{6cm}} \\
Signature/Unterschrift
\end{center}
} 

\end{otherlanguage}




% --- English Abstract ----------------------------------------------------


\cleardoublepage

\vspace*{2cm}

\begin{center}
{\Large\sffamily\bfseries Abstract}
\end{center}
% Motivation
In light of the growing number of individuals working from home, the importance of secure \acl{vpn} communication protocols has increased significantly. Consequently, the need for rigorous security testing of \acl{vpn} software has become more critical than ever before. 
In this thesis, we employ \acl{aal} to demonstrate how behavioral models of two black-box \acl{ipsec} \acl{vpn} implementations can be automatically learned. We subsequently utilize the learned models to facilitate security testing the \acl{ipsec} implementations through model-based fuzzing. 
More specifically, we first learn behavioral models of strongSwan and libreswan \acl{ipsec} servers using both the $L^*$ and $KV$ model learning algorithms. Learned models of both \acl{ipsec} implementations are presented and the utilized learning algorithms are compared and evaluated. The learned models are then used to perform model-based fuzzing of the respective implementations. While fuzzing, new behavior is detected by utilizing the previously-learned models as a reference. Additionally, we employ search-based methods, including a genetic algorithm-based approach, aided by the learned models, in order to enhance the effectiveness of fuzzing. Our fuzzing analysis uncovered several new security issues, including several standard violations and a potential deadlock state. Furthermore, our model learning approach led to the discovery of a bug in a cryptographic Python library.

\begin{center}
	{\Large\sffamily\bfseries Abstract German}
\end{center}
% Motivation
Aufgrund der stetig steigenden Anzahl an Personen, die von zu Hause aus arbeiten, hat die Wichtigkeit sicherer \acl{vpn}-Kommunikationsprotokolle erheblich zugenommen. Infolgedessen ist die Notwendigkeit strenger Sicherheitskontrollen für \acl{vpn}-Software wichtiger denn je zuvor. In dieser Masterarbeit verwenden wir \acl{aal}, um Verhaltensmodelle von zwei \acl{ipsec} \acl{vpn}-Implementationen, strongSwan und libreswan, automatisiert zu lernen. Dazu verwenden wir die $L^*$ und $KV$ Automatenlern-Algorithmen. Die Verhaltensmodelle und die fürs Lernen verwendeten Automatenlern-Algorithmen werden präsentiert und verglichen. Anschließend werden die erlernten Modelle verwendet um modell-basiertes Fuzzing der jeweiligen Implementierungen zu betreiben. Während dem Fuzzing wird neues Verhalten mithilfe der zuvor erlernten Modelle entdeckt. Des Weiteren setzen wir suchbasierte Methoden ein, inklusive eines genetischen Algorithmus, um die Effektivität des Fuzzings zu verbessern. Unsere Tests haben einige potenzielle Sicherheitslücken enthüllt, darunter mehrere Verstöße gegen Standards und ein potenzieller Deadlock-Zustand. Darüber hinaus hat unser Automatenlernen zu der Entdeckung eines Fehlers in einer kryptografischen Python-Library geführt.
