%----------------------------------------------------------------
%
%  File    :  thesis-embed.tex
%
%  Author  :  Keith Andrews, IICM, TU Graz, Austria
% 
%  Created :  22 Feb 96
% 
%  Changed :  19 Feb 2004
% 
%----------------------------------------------------------------

\chapter{Introduction}

\label{chap:Introduction}

%TODO: expand on
% Background
\section{Motivation}
\ac{vpn} are used to allow secure communication over an insecure channel. They function by creating a secure encrypted tunnel through which users can send their data. Example use cases include additional privacy from prying eyes such as Internet Server Providers, access to region-locked online content and secure remote access to company networks. The importance of \ac{vpn} software has increased dramatically since the beginning of the COVID-19 pandemic due to the influx of people working from home \parencite{abhijith2020impact}. This makes finding vulnerabilities in \ac{vpn} software more critical than ever. % state reports on damages by vpn errors? 
% IPSEC
\ac{ipsec} is a popular \ac{vpn} protocol and most commonly uses the \ac{ike} protocol to share authenticated keying material between involved parties. Therefore, \ac{ike} and \ac{ipsec} are sometimes used interchangeably. We will stick to the official nomenclature of using \ac{ipsec} for the full protocol and \ac{ike} for the key exchange only. \ac{ike} has two versions, \ac{ike}v1 and \ac{ike}v2, with \ac{ike}v2 being the newer and recommended version \parencite{nist791491}. However, despite \ac{ike}v2 supposedly replacing its predecessor, \ac{ike}v1, sometimes also called Cisco \ac{ipsec}, is still in widespread use today. This is reflected by the company AVM to this day only offering \ac{ike}v1 support for their popular FRITZ!Box routers \parencite{avm2022}. Additionally, \ac{ike}v1 is also used for the L2TP/\ac{ipsec} protocol, one of the most popular \ac{vpn} protocols according to NordVPN \parencite{nordvpn2021}. The widespread usage of \ac{ipsec}-\ac{ike}v1, combined with its relative age and many options makes it an interesting target for security testing.


\section{Research Problems and Goals}
% Automata Learning
State machines of protocol implementations are useful tools in state-of-the-art software testing. They have, e.g., been used to detect specific software implementations, or to generate test cases automatically \parencites{pferscher2021fingerprinting, pferscher2022fuzzing}. Mealy machines are a type of state machine that can be used to describe the behavior a system when faced with external input. Often we are interested in testing software without knowing its exact inner workings. We call these systems black-box systems. However, despite lacking information on the inner structure of a black-box system, the state machine of the system can still be extracted. One method of generating the state machine of such a system is to use active automata learning. A notable example of an active automata learning algorithm is the $L^*$ algorithm by Angluin \parencite{angluin1987learning}. In $L^*$, a learner queries the \ac{sul} and constructs an automaton describing the behavior of the \ac{sul} through its responses. This automaton is then compared with the \ac{sul}, adapting it if they show different behaviors. The resulting automaton then fully describes the behavior of the \ac{sul}.

% Problem / motivation
By combining automata learning with fuzzing or similar software testing techniques, network protocols can be extensively and automatically tested without requiring access to their source code. Guo et al.~\parencite{guo2019model} tested \ac{ipsec}-\ac{ike}v2 using automata learning and model checking, however so far, no studies have focused on \ac{ike}v1 in the context of automata learning. Therefore our goal was to black-box test the \ac{ipsec}-\ac{ike}v1 protocol using automata learning in combination with automata-based fuzzing. We used the active automata learning framework \textsc{AALpy} \parencite{muvskardin2022aalpy} with a custom mapper to learn the state machines of various \ac{ipsec}-\ac{ike}v1 server implementations. We then further utilized the learned models for fuzzing and fingerprinting. % TODO: add any findings here

% Expand this section more
\section{Structure}
This thesis is structured as follows. Chapter~\ref{chap:Related} gives an overview of related and relevant literature. Chapter~\ref{chap:Preliminaries} introduces necessary background knowledge, covering the \ac{ipsec}-\ac{ike}v1 protocol, Mealy machines, automata learning and fuzzing. Our learning setup, custom mapper and fuzzing methodology are presented in chapter~\ref{chap:Learning}. In chapter~\ref{chap:Evaluation} we present and analyze the learned models and the results of the fuzzing tests.
Finally we summarize the thesis in chapter~\ref{chap:Conclusion} and discuss future work.